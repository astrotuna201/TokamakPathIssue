//
//  Model.swift
//  
//
//  Created by wiggles on 02/07/2022.
//

import Foundation
import TokamakShim

public struct DataPoint: Identifiable, Hashable {
  public var id: Int {self.hashValue}
  public var x: Double
  public var value: Double // between 0...1
    
  public func point(in dataTile: DataTile) -> UnitPoint {
    let x = (x - dataTile.xRange.lower)/dataTile.xRange.size
    let y = (dataTile.yRange.upper - value)/dataTile.yRange.size
      return UnitPoint(x: x, y: y)
  }
  
  public func hash(into hasher: inout Hasher) {
    hasher.combine(x)
    hasher.combine(value)
    let _ = hasher.finalize()
  }
  
  public init(x: Double, value: Double) {
    self.x = x
    self.value = value
  }
}

public struct DataTile: Identifiable {
  public var values: [DataPoint]
  public var xRange: DoubleAxisRange
  public var yRange: DoubleAxisRange
  public var id: Double { xRange.lower }
}

extension Array {
    func chunked(into size: Int) -> [[Element]] {
        return stride(from: 0, to: count, by: size).map {
            Array(self[$0 ..< Swift.min($0 + size, count)])
        }
    }
}

public final class Model {
  public var dataTiles: [DataTile] = []
  public static let shared = Model.init()
  public init() {
    let data = ageEcc
    
    let xRange = AxisRange(lower: data.map{$0[0]}.min() ?? 0,
                           upper: (data.map{$0[0]}.max() ?? 1) + 0.001)
    let yRange = AxisRange(lower: data.map{$0[1]}.min() ?? 0,
                           upper: data.map{$0[1]}.max() ?? 1)
    
    let axisTicker = AxisTickMarks(strategy: .tssReadability)
    let (xTicks, _, _) = axisTicker.generate(range: xRange, generateSubTicks: false, generateLabels: false)
    
    let tileCount = xTicks.count - 1
    
    let chunkedData = data.chunked(into: data.count/tileCount)

    let tiles: [DataTile] = chunkedData.map{ chunk in
      let chunkXRange = AxisRange(lower: chunk.map{$0[0]}.min() ?? 0,
                               upper: chunk.map{$0[0]}.max() ?? 1)
      let points = chunk.map {DataPoint(x: $0[0], value: $0[1])}
      return DataTile(values: points, xRange: chunkXRange, yRange: yRange)
    }
    dataTiles = tiles
  }
}

let ageEcc: [[Double]] = [
  [0.0000,0.016708617402687],
  [0.0010,0.017116104708126],
  [0.0020,0.017497196592942],
  [0.0030,0.017850974506034],
  [0.0040,0.018176462974713],
  [0.0050,0.018472629886587],
  [0.0060,0.018738406224449],
  [0.0070,0.018972715109011],
  [0.0080,0.019174526745350],
  [0.0090,0.019342922779179],
  [0.0100,0.019477167585410],
  [0.0110,0.019576778165549],
  [0.0120,0.019641584554053],
  [0.0130,0.019671771534167],
  [0.0140,0.019667908655683],
  [0.0150,0.019630942188028],
  [0.0160,0.019562174456466],
  [0.0170,0.019463215984140],
  [0.0180,0.019335921041799],
  [0.0190,0.019182317786217],
  [0.0200,0.019004528779685],
  [0.0210,0.018804711470320],
  [0.0220,0.018584997911736],
  [0.0230,0.018347468310503],
  [0.0240,0.018094136161653],
  [0.0250,0.017826959943281],
  [0.0260,0.017547885047896],
  [0.0270,0.017258885393655],
  [0.0280,0.016962032252065],
  [0.0290,0.016659551428796],
  [0.0300,0.016353891025202],
  [0.0310,0.016047765193848],
  [0.0320,0.015744184570362],
  [0.0330,0.015446463360241],
  [0.0340,0.015158204240682],
  [0.0350,0.014883255582854],
  [0.0360,0.014625639532155],
  [0.0370,0.014389466719225],
  [0.0380,0.014178825212451],
  [0.0390,0.013997663073904],
  [0.0400,0.013849656972287],
  [0.0410,0.013738090200461],
  [0.0420,0.013665728843945],
  [0.0430,0.013634722099221],
  [0.0440,0.013646520247243],
  [0.0450,0.013701823477642],
  [0.0460,0.013800566824910],
  [0.0470,0.013941937371165],
  [0.0480,0.014124422419413],
  [0.0490,0.014345895742071],
  [0.0500,0.014603718415791],
  [0.0510,0.014894858727961],
  [0.0520,0.015216021493285],
  [0.0530,0.015563775641417],
  [0.0540,0.015934681424466],
  [0.0550,0.016325407180907],
  [0.0560,0.016732827564720],
  [0.0570,0.017154110830358],
  [0.0580,0.017586789138964],
  [0.0590,0.018028797849562],
  [0.0600,0.018478503265467],
  [0.0610,0.018934698473254],
  [0.0620,0.019396590625661],
  [0.0630,0.019863755539771],
  [0.0640,0.020336085975082],
  [0.0650,0.020813731644558],
  [0.0660,0.021297023449402],
  [0.0670,0.021786405245754],
  [0.0680,0.022282363863981],
  [0.0690,0.022785369602636],
  [0.0700,0.023295821904700],
  [0.0710,0.023814009758537],
  [0.0720,0.024340084755627],
  [0.0730,0.024874043971989],
  [0.0740,0.025415727525083],
  [0.0750,0.025964829699190],
  [0.0760,0.026520909655747],
  [0.0770,0.027083423676725],
  [0.0780,0.027651745541610],
  [0.0790,0.028225197788191],
  [0.0800,0.028803081301582],
  [0.0810,0.029384691586278],
  [0.0820,0.029969338077158],
  [0.0830,0.030556345152987],
  [0.0840,0.031145052213169],
  [0.0850,0.031734802347992],
  [0.0860,0.032324917793906],
  [0.0870,0.032914680720249],
  [0.0880,0.033503301154688],
  [0.0890,0.034089889579388],
  [0.0900,0.034673432093838],
  [0.0910,0.035252773592613],
  [0.0920,0.035826605965976],
  [0.0930,0.036393469740415],
  [0.0940,0.036951763608758],
  [0.0950,0.037499777806992],
  [0.0960,0.038035716438449],
  [0.0970,0.038557745395280],
  [0.0980,0.039064031967747],
  [0.0990,0.039552789943726],
  [0.1000,0.040022312576016],
  [0.1010,0.040470999012413],
  [0.1020,0.040897370729606],
  [0.1030,0.041300067588304],
  [0.1040,0.041677836229414],
  [0.1050,0.042029502784757],
  [0.1060,0.042353935645070],
  [0.1070,0.042650008469307],
  [0.1080,0.042916559211958],
  [0.1090,0.043152358389955],
  [0.1100,0.043356085265084],
  [0.1110,0.043526327548089],
  [0.1120,0.043661587569494],
  [0.1130,0.043760323668310],
  [0.1140,0.043820998167006],
  [0.1150,0.043842148944450],
  [0.1160,0.043822466655162],
  [0.1170,0.043760880909035],
  [0.1180,0.043656636949767],
  [0.1190,0.043509365591208],
  [0.1200,0.043319128832979],
  [0.1210,0.043086450371894],
  [0.1220,0.042812308357297],
  [0.1230,0.042498111140245],
  [0.1240,0.042145648246463],
  [0.1250,0.041757017792251],
  [0.1260,0.041334546322168],
  [0.1270,0.040880711833801],
  [0.1280,0.040398061004776],
  [0.1290,0.039889149125972],
  [0.1300,0.039356491868804],
  [0.1310,0.038802544535511],
  [0.1320,0.038229706489639],
  [0.1330,0.037640342448314],
  [0.1340,0.037036836744299],
  [0.1350,0.036421648857260],
  [0.1360,0.035797389612158],
  [0.1370,0.035166895101812],
  [0.1380,0.034533293136704],
  [0.1390,0.033900060238108],
  [0.1400,0.033271050633058],
  [0.1410,0.032650516110213],
  [0.1420,0.032043084622881],
  [0.1430,0.031453713919428],
  [0.1440,0.030887631343283],
  [0.1450,0.030350229646068],
  [0.1460,0.029846956121043],
  [0.1470,0.029383185343581],
  [0.1480,0.028964077664157],
  [0.1490,0.028594434540389],
  [0.1500,0.028278558231571],
  [0.1510,0.028020121355935],
  [0.1520,0.027822043234524],
  [0.1530,0.027686397199333],
  [0.1540,0.027614340145604],
  [0.1550,0.027606073563629],
  [0.1560,0.027660836477371],
  [0.1570,0.027776939971409],
  [0.1580,0.027951834604610],
  [0.1590,0.028182206676934],
  [0.1600,0.028464104633221],
  [0.1610,0.028793082711648],
  [0.1620,0.029164362630406],
  [0.1630,0.029572992616442],
  [0.1640,0.030014012625432],
  [0.1650,0.030482593236245],
  [0.1660,0.030974170358413],
  [0.1670,0.031484545412576],
  [0.1680,0.032009956036185],
  [0.1690,0.032547115967862],
  [0.1700,0.033093216532223],
  [0.1710,0.033645904731073],
  [0.1720,0.034203226070478],
  [0.1730,0.034763554766296],
  [0.1740,0.035325507453903],
  [0.1750,0.035887859620332],
  [0.1760,0.036449465042892],
  [0.1770,0.037009186071650],
  [0.1780,0.037565844838432],
  [0.1790,0.038118196841617],
  [0.1800,0.038664925254544],
  [0.1810,0.039204650257500],
  [0.1820,0.039735968565780],
  [0.1830,0.040257491709479],
  [0.1840,0.040767905478091],
  [0.1850,0.041266019635699],
  [0.1860,0.041750824589642],
  [0.1870,0.042221531245382],
  [0.1880,0.042677603910182],
  [0.1890,0.043118771968374],
  [0.1900,0.043545029114826],
  [0.1910,0.043956604343106],
  [0.1920,0.044353929116271],
  [0.1930,0.044737575990293],
  [0.1940,0.045108199114848],
  [0.1950,0.045466458961305],
  [0.1960,0.045812952519190],
  [0.1970,0.046148147561715],
  [0.1980,0.046472326588109],
  [0.1990,0.046785545070904],
  [0.2000,0.047087611837474],
  [0.2010,0.047378081743503],
  [0.2020,0.047656273897654],
  [0.2030,0.047921308660796],
  [0.2040,0.048172157686663],
  [0.2050,0.048407698020961],
  [0.2060,0.048626786787105],
  [0.2070,0.048828311923372],
  [0.2080,0.049011254075474],
  [0.2090,0.049174719881916],
  [0.2100,0.049317962642976],
  [0.2110,0.049440380593404],
  [0.2120,0.049541495623608],
  [0.2130,0.049620905804087],
  [0.2140,0.049678233479001],
  [0.2150,0.049713054130281],
  [0.2160,0.049724829320865],
  [0.2170,0.049712842913110],
  [0.2180,0.049676156017622],
  [0.2190,0.049613578266581],
  [0.2200,0.049523663472382],
  [0.2210,0.049404741019267],
  [0.2220,0.049254971271748],
  [0.2230,0.049072423768602],
  [0.2240,0.048855180024872],
  [0.2250,0.048601439525112],
  [0.2260,0.048309637954764],
  [0.2270,0.047978543291834],
  [0.2280,0.047607339473618],
  [0.2290,0.047195680202458],
  [0.2300,0.046743706767144],
  [0.2310,0.046252034363335],
  [0.2320,0.045721699551697],
  [0.2330,0.045154081509002],
  [0.2340,0.044550796792753],
  [0.2350,0.043913593106404],
  [0.2360,0.043244234841668],
  [0.2370,0.042544407323063],
  [0.2380,0.041815651743533],
  [0.2390,0.041059323170178],
  [0.2400,0.040276596637695],
  [0.2410,0.039468512534098],
  [0.2420,0.038636052518050],
  [0.2430,0.037780251162684],
  [0.2440,0.036902322387657],
  [0.2450,0.036003791739210],
  [0.2460,0.035086624153321],
  [0.2470,0.034153329042413],
  [0.2480,0.033207039540657],
  [0.2490,0.032251549750051],
  [0.2500,0.031291328481959],
  [0.2510,0.030331481195172],
  [0.2520,0.029377690700182],
  [0.2530,0.028436138132830],
  [0.2540,0.027513400229640],
  [0.2550,0.026616348488103],
  [0.2560,0.025752048324531],
  [0.2570,0.024927664504537],
  [0.2580,0.024150366925430],
  [0.2590,0.023427242404143],
  [0.2600,0.022765190594684],
  [0.2610,0.022170803950400],
  [0.2620,0.021650206749275],
  [0.2630,0.021208865551893],
  [0.2640,0.020851362972423],
  [0.2650,0.020581146899423],
  [0.2660,0.020400296054349],
  [0.2670,0.020309323890890],
  [0.2680,0.020307071659191],
  [0.2690,0.020390705523960],
  [0.2700,0.020555834299429],
  [0.2710,0.020796745355972],
  [0.2720,0.021106711766748],
  [0.2730,0.021478349891115],
  [0.2740,0.021903974840808],
  [0.2750,0.022375920182867],
  [0.2760,0.022886792373679],
  [0.2770,0.023429658306363],
  [0.2780,0.023998142971569],
  [0.2790,0.024586475778600],
  [0.2800,0.025189457874218],
  [0.2810,0.025802404636886],
  [0.2820,0.026421063832093],
  [0.2830,0.027041513633929],
  [0.2840,0.027660083872973],
  [0.2850,0.028273286258678],
  [0.2860,0.028877761162428],
  [0.2870,0.029470270587689],
  [0.2880,0.030047695068107],
  [0.2890,0.030607070886670],
  [0.2900,0.031145635138275],
  [0.2910,0.031660884472676],
  [0.2920,0.032150636002475],
  [0.2930,0.032613084937330],
  [0.2940,0.033046849661470],
  [0.2950,0.033450992978727],
  [0.2960,0.033825037264247],
  [0.2970,0.034168933418672],
  [0.2980,0.034483030391322],
  [0.2990,0.034768003501649],
  [0.3000,0.035024776795966],
  [0.3010,0.035254433495843],
  [0.3020,0.035458122374930],
  [0.3030,0.035636969902539],
  [0.3040,0.035792001345365],
  [0.3050,0.035924083773564],
  [0.3060,0.036033888461251],
  [0.3070,0.036121876641990],
  [0.3080,0.036188309958080],
  [0.3090,0.036233278683717],
  [0.3100,0.036256751901097],
  [0.3110,0.036258631124551],
  [0.3120,0.036238813217861],
  [0.3130,0.036197247944382],
  [0.3140,0.036133986182826],
  [0.3150,0.036049216023786],
  [0.3160,0.035943278155157],
  [0.3170,0.035816663396631],
  [0.3180,0.035669991500815],
  [0.3190,0.035503969881242],
  [0.3200,0.035319345660444],
  [0.3210,0.035116842605086],
  [0.3220,0.034897102453631],
  [0.3230,0.034660629675863],
  [0.3240,0.034407746893046],
  [0.3250,0.034138564551022],
  [0.3260,0.033852973660414],
  [0.3270,0.033550649011352],
  [0.3280,0.033231076939563],
  [0.3290,0.032893601045634],
  [0.3300,0.032537467780215],
  [0.3310,0.032161892198310],
  [0.3320,0.031766115055033],
  [0.3330,0.031349463583995],
  [0.3340,0.030911398446927],
  [0.3350,0.030451554246430],
  [0.3360,0.029969757294568],
  [0.3370,0.029466037914808],
  [0.3380,0.028940609710766],
  [0.3390,0.028393852743755],
  [0.3400,0.027826262289362],
  [0.3410,0.027238406229252],
  [0.3420,0.026630862413179],
  [0.3430,0.026004173032900],
  [0.3440,0.025358789354759],
  [0.3450,0.024695043532389],
  [0.3460,0.024013133034625],
  [0.3470,0.023313123114794],
  [0.3480,0.022594976888303],
  [0.3490,0.021858610243701],
  [0.3500,0.021103960176298],
  [0.3510,0.020331077667788],
  [0.3520,0.019540222042178],
  [0.3530,0.018731956938691],
  [0.3540,0.017907243276729],
  [0.3550,0.017067508847849],
  [0.3560,0.016214695823539],
  [0.3570,0.015351281090407],
  [0.3580,0.014480265657941],
  [0.3590,0.013605140933196],
  [0.3600,0.012729833243274],
  [0.3610,0.011858658033996],
  [0.3620,0.010996276111657],
  [0.3630,0.010147718274539],
  [0.3640,0.009318478233959],
  [0.3650,0.008514754798375],
  [0.3660,0.007743869279053],
  [0.3670,0.007014945978829],
  [0.3680,0.006339881633246],
  [0.3690,0.005734522449852],
  [0.3700,0.005219689805625],
  [0.3710,0.004821005169422],
  [0.3720,0.004565741900152],
  [0.3730,0.004475458861656],
  [0.3740,0.004556900118385],
  [0.3750,0.004797861809430],
  [0.3760,0.005171867890590],
  [0.3770,0.005647285405682],
  [0.3780,0.006194407062459],
  [0.3790,0.006788418747228],
  [0.3800,0.007409635539416],
  [0.3810,0.008042703648424],
  [0.3820,0.008675676053509],
  [0.3830,0.009299284907966],
  [0.3840,0.009906415230755],
  [0.3850,0.010491748802797],
  [0.3860,0.011051492351277],
  [0.3870,0.011583158486506],
  [0.3880,0.012085348211671],
  [0.3890,0.012557521863601],
  [0.3900,0.012999770175578],
  [0.3910,0.013412565121540],
  [0.3920,0.013796526560484],
  [0.3930,0.014152203948822],
  [0.3940,0.014479905099210],
  [0.3950,0.014779580471042],
  [0.3960,0.015050767154996],
  [0.3970,0.015292605889439],
  [0.3980,0.015503913993137],
  [0.3990,0.015683312896701],
  [0.4000,0.015829379138715],
  [0.4010,0.015940820049438],
  [0.4020,0.016016625459849],
  [0.4030,0.016056209067132],
  [0.4040,0.016059495481391],
  [0.4050,0.016026968650508],
  [0.4060,0.015959662424888],
  [0.4070,0.015859100077155],
  [0.4080,0.015727189618072],
  [0.4090,0.015566093392682],
  [0.4100,0.015378073896408],
  [0.4110,0.015165344001728],
  [0.4120,0.014929933388972],
  [0.4130,0.014673593702585],
  [0.4140,0.014397731780541],
  [0.4150,0.014103410140435],
  [0.4160,0.013791387590953],
  [0.4170,0.013462204704718],
  [0.4180,0.013116313488249],
  [0.4190,0.012754217818506],
  [0.4200,0.012376629435051],
  [0.4210,0.011984616677097],
  [0.4220,0.011579727596924],
  [0.4230,0.011164094101253],
  [0.4240,0.010740491898646],
  [0.4250,0.010312371230590],
  [0.4260,0.009883850010512],
  [0.4270,0.009459674714503],
  [0.4280,0.009045163514901],
  [0.4290,0.008646129840822],
  [0.4300,0.008268788018845],
  [0.4310,0.007919649685780],
  [0.4320,0.007605407085889],
  [0.4330,0.007332775918259],
  [0.4340,0.007108303489658],
  [0.4350,0.006938113898848],
  [0.4360,0.006827604850278],
  [0.4370,0.006781111627473],
  [0.4380,0.006801605173946],
  [0.4390,0.006890471830792],
  [0.4400,0.007047459975679],
  [0.4410,0.007270775132674],
  [0.4420,0.007557322319253],
  [0.4430,0.007903023235064],
  [0.4440,0.008303141687355],
  [0.4450,0.008752570270496],
  [0.4460,0.009246071421122],
  [0.4470,0.009778446288032],
  [0.4480,0.010344668628302],
  [0.4490,0.010939981961423],
  [0.4500,0.011559971679763],
  [0.4510,0.012200621554648],
  [0.4520,0.012858356767331],
  [0.4530,0.013530069164017],
  [0.4540,0.014213124753130],
  [0.4550,0.014905354843519],
  [0.4560,0.015605018746402],
  [0.4570,0.016310752695768],
  [0.4580,0.017021492113117],
  [0.4590,0.017736386015543],
  [0.4600,0.018454696680800],
  [0.4610,0.019175698208959],
  [0.4620,0.019898589592618],
  [0.4630,0.020622408115345],
  [0.4640,0.021345981117788],
  [0.4650,0.022067891980233],
  [0.4660,0.022786480135313],
  [0.4670,0.023499866864752],
  [0.4680,0.024206006455687],
  [0.4690,0.024902752267150],
  [0.4700,0.025587932817492],
  [0.4710,0.026259427714386],
  [0.4720,0.026915236136496],
  [0.4730,0.027553532399530],
  [0.4740,0.028172700634692],
  [0.4750,0.028771346549852],
  [0.4760,0.029348292125747],
  [0.4770,0.029902540959366],
  [0.4780,0.030433239811433],
  [0.4790,0.030939612064391],
  [0.4800,0.031420899300898],
  [0.4810,0.031876297453132],
  [0.4820,0.032304899449203],
  [0.4830,0.032705656736223],
  [0.4840,0.033077349212862],
  [0.4850,0.033418588769383],
  [0.4860,0.033727831118641],
  [0.4870,0.034003417043556],
  [0.4880,0.034243625028155],
  [0.4890,0.034446733389381],
  [0.4900,0.034611093958143],
  [0.4910,0.034735197015931],
  [0.4920,0.034817735316457],
  [0.4930,0.034857654057294],
  [0.4940,0.034854187351820],
  [0.4950,0.034806876219807],
  [0.4960,0.034715572327508],
  [0.4970,0.034580413890425],
  [0.4980,0.034401794124604],
  [0.4990,0.034180308263995],
  [0.5000,0.033916694475575],
  [0.5010,0.033611770468246],
  [0.5020,0.033266366132275],
  [0.5030,0.032881279062843],
  [0.5040,0.032457230935537],
  [0.5050,0.031994854341141],
  [0.5060,0.031494700769173],
  [0.5070,0.030957275592547],
  [0.5080,0.030383085937193],
  [0.5090,0.029772716197729],
  [0.5100,0.029126910220886],
  [0.5110,0.028446653304552],
  [0.5120,0.027733252532375],
  [0.5130,0.026988401201713],
  [0.5140,0.026214232003917],
  [0.5150,0.025413343880297],
  [0.5160,0.024588808309281],
  [0.5170,0.023744163551491],
  [0.5180,0.022883387625218],
  [0.5190,0.022010870647687],
  [0.5200,0.021131392180324],
  [0.5210,0.020250113235133],
  [0.5220,0.019372586218503],
  [0.5230,0.018504811047485],
  [0.5240,0.017653316413727],
  [0.5250,0.016825287319092],
  [0.5260,0.016028713876732],
  [0.5270,0.015272549616005],
  [0.5280,0.014566834534929],
  [0.5290,0.013922731024419],
  [0.5300,0.013352389710724],
  [0.5310,0.012868562508090],
  [0.5320,0.012483886821422],
  [0.5330,0.012209851609829],
  [0.5340,0.012055537865174],
  [0.5350,0.012026420315901],
  [0.5360,0.012123531087816],
  [0.5370,0.012343278230076],
  [0.5380,0.012677977173128],
  [0.5390,0.013116925261833],
  [0.5400,0.013647690927253],
  [0.5410,0.014257317561052],
  [0.5420,0.014933246210451],
  [0.5430,0.015663911254057],
  [0.5440,0.016439026366329],
  [0.5450,0.017249656423903],
  [0.5460,0.018088142465801],
  [0.5470,0.018947952814331],
  [0.5480,0.019823494682791],
  [0.5490,0.020709936581987],
  [0.5500,0.021603047359104],
  [0.5510,0.022499070294652],
  [0.5520,0.023394627598308],
  [0.5530,0.024286663600593],
  [0.5540,0.025172429011696],
  [0.5550,0.026049474122049],
  [0.5560,0.026915674782465],
  [0.5570,0.027769249249894],
  [0.5580,0.028608789611673],
  [0.5590,0.029433263862198],
  [0.5600,0.030242020439045],
  [0.5610,0.031034754841357],
  [0.5620,0.031811471460345],
  [0.5630,0.032572416411815],
  [0.5640,0.033318001882874],
  [0.5650,0.034048721263057],
  [0.5660,0.034765059052619],
  [0.5670,0.035467411003148],
  [0.5680,0.036156010320646],
  [0.5690,0.036830877237905],
  [0.5700,0.037491781566262],
  [0.5710,0.038138238985104],
  [0.5720,0.038769524510137],
  [0.5730,0.039384708708394],
  [0.5740,0.039982711250863],
  [0.5750,0.040562369546435],
  [0.5760,0.041122501376813],
  [0.5770,0.041661975400112],
  [0.5780,0.042179764299804],
  [0.5790,0.042674982078626],
  [0.5800,0.043146903335956],
  [0.5810,0.043594963632174],
  [0.5820,0.044018734722841],
  [0.5830,0.044417886040152],
  [0.5840,0.044792136927643],
  [0.5850,0.045141188641632],
  [0.5860,0.045464671457060],
  [0.5870,0.045762084248429],
  [0.5880,0.046032752679302],
  [0.5890,0.046275800574228],
  [0.5900,0.046490139865580],
  [0.5910,0.046674481859767],
  [0.5920,0.046827377503542],
  [0.5930,0.046947263792640],
  [0.5940,0.047032529361751],
  [0.5950,0.047081593496170],
  [0.5960,0.047092976246936],
  [0.5970,0.047065364442635],
  [0.5980,0.046997671033632],
  [0.5990,0.046889066600432],
  [0.6000,0.046738996143160],
  [0.6010,0.046547169487800],
  [0.6020,0.046313530894830],
  [0.6030,0.046038211292108],
  [0.6040,0.045721463192067],
  [0.6050,0.045363597559993],
  [0.6060,0.044964902799047],
  [0.6070,0.044525596061115],
  [0.6080,0.044045762957245],
  [0.6090,0.043525341710809],
  [0.6100,0.042964115883245],
  [0.6110,0.042361743765274],
  [0.6120,0.041717813578496],
  [0.6130,0.041031919357579],
  [0.6140,0.040303756743992],
  [0.6150,0.039533222319411],
  [0.6160,0.038720514367086],
  [0.6170,0.037866222679184],
  [0.6180,0.036971393620374],
  [0.6190,0.036037575008390],
  [0.6200,0.035066829783499],
  [0.6210,0.034061716849527],
  [0.6220,0.033025254155952],
  [0.6230,0.031960856638516],
  [0.6240,0.030872269231024],
  [0.6250,0.029763492356857],
  [0.6260,0.028638725012008],
  [0.6270,0.027502326644997],
  [0.6280,0.026358809716589],
  [0.6290,0.025212865994861],
  [0.6300,0.024069445960246],
  [0.6310,0.022933876356464],
  [0.6320,0.021812030574212],
  [0.6330,0.020710541818438],
  [0.6340,0.019637046585207],
  [0.6350,0.018600449219552],
  [0.6360,0.017611180212750],
  [0.6370,0.016681394266622],
  [0.6380,0.015825050039668],
  [0.6390,0.015057758155145],
  [0.6400,0.014396281197625],
  [0.6410,0.013857554039189],
  [0.6420,0.013457190489837],
  [0.6430,0.013207610581316],
  [0.6440,0.013116169290297],
  [0.6450,0.013183854557344],
  [0.6460,0.013405004719668],
  [0.6470,0.013768198894590],
  [0.6480,0.014257956905353],
  [0.6490,0.014856716957404],
  [0.6500,0.015546563983497],
  [0.6510,0.016310449881220],
  [0.6520,0.017132875156872],
  [0.6530,0.018000144152406],
  [0.6540,0.018900337377101],
  [0.6550,0.019823143844400],
  [0.6560,0.020759627897933],
  [0.6570,0.021702011463002],
  [0.6580,0.022643475013636],
  [0.6590,0.023578013279057],
  [0.6600,0.024500336565926],
  [0.6610,0.025405802654475],
  [0.6620,0.026290393982459],
  [0.6630,0.027150703475369],
  [0.6640,0.027983933998840],
  [0.6650,0.028787891808761],
  [0.6660,0.029560967724473],
  [0.6670,0.030302105527479],
  [0.6680,0.031010737035393],
  [0.6690,0.031686710034875],
  [0.6700,0.032330182112336],
  [0.6710,0.032941525450303],
  [0.6720,0.033521211857159],
  [0.6730,0.034069723545191],
  [0.6740,0.034587465406079],
  [0.6750,0.035074714455092],
  [0.6760,0.035531582585822],
  [0.6770,0.035958017247258],
  [0.6780,0.036353817740493],
  [0.6790,0.036718678079196],
  [0.6800,0.037052243261978],
  [0.6810,0.037354177464650],
  [0.6820,0.037624228880282],
  [0.6830,0.037862295692561],
  [0.6840,0.038068470309052],
  [0.6850,0.038243070585757],
  [0.6860,0.038386648773166],
  [0.6870,0.038499966640158],
  [0.6880,0.038583960092603],
  [0.6890,0.038639677909441],
  [0.6900,0.038668213044626],
  [0.6910,0.038670622936664],
  [0.6920,0.038647864925153],
  [0.6930,0.038600724005162],
  [0.6940,0.038529769764670],
  [0.6950,0.038435326768533],
  [0.6960,0.038317462023583],
  [0.6970,0.038176002937190],
  [0.6980,0.038010572503968],
  [0.6990,0.037820639945706],
  [0.7000,0.037605599806098],
  [0.7010,0.037364839681516],
  [0.7020,0.037097828899725],
  [0.7030,0.036804186374494],
  [0.7040,0.036483739511720],
  [0.7050,0.036136559624912],
  [0.7060,0.035762977764251],
  [0.7070,0.035363568215352],
  [0.7080,0.034939112091247],
  [0.7090,0.034490532720156],
  [0.7100,0.034018819951939],
  [0.7110,0.033524943227252],
  [0.7120,0.033009757047650],
  [0.7130,0.032473920120192],
  [0.7140,0.031917824939685],
  [0.7150,0.031341553168078],
  [0.7160,0.030744867768542],
  [0.7170,0.030127229738008],
  [0.7180,0.029487862143034],
  [0.7190,0.028825842517295],
  [0.7200,0.028140220791289],
  [0.7210,0.027430159711701],
  [0.7220,0.026695067007721],
  [0.7230,0.025934727309905],
  [0.7240,0.025149409056562],
  [0.7250,0.024339933675779],
  [0.7260,0.023507709531013],
  [0.7270,0.022654718846097],
  [0.7280,0.021783466649885],
  [0.7290,0.020896893351817],
  [0.7300,0.019998256128026],
  [0.7310,0.019091008821063],
  [0.7320,0.018178680738737],
  [0.7330,0.017264783591819],
  [0.7340,0.016352763721238],
  [0.7350,0.015446019946254],
  [0.7360,0.014547997913524],
  [0.7370,0.013662379806992],
  [0.7380,0.012793380692178],
  [0.7390,0.011946137075764],
  [0.7400,0.011127203273768],
  [0.7410,0.010345125390510],
  [0.7420,0.009611031735932],
  [0.7430,0.008939141564210],
  [0.7440,0.008346934801507],
  [0.7450,0.007854597815413],
  [0.7460,0.007483226777261],
  [0.7470,0.007251487835891],
  [0.7480,0.007171282025968],
  [0.7490,0.007244085764679],
  [0.7500,0.007460028874272],
  [0.7510,0.007800309238473],
  [0.7520,0.008241525560189],
  [0.7530,0.008759837027800],
  [0.7540,0.009333686713728],
  [0.7550,0.009945014652404],
  [0.7560,0.010579435666513],
  [0.7570,0.011225867613222],
  [0.7580,0.011875961429113],
  [0.7590,0.012523484137027],
  [0.7600,0.013163755132934],
  [0.7610,0.013793149259155],
  [0.7620,0.014408688903246],
  [0.7630,0.015007724003218],
  [0.7640,0.015587709191193],
  [0.7650,0.016146060043851],
  [0.7660,0.016680101763964],
  [0.7670,0.017187086430753],
  [0.7680,0.017664263231650],
  [0.7690,0.018108993546072],
  [0.7700,0.018518873416388],
  [0.7710,0.018891866534046],
  [0.7720,0.019226406522916],
  [0.7730,0.019521475922006],
  [0.7740,0.019776637313291],
  [0.7750,0.019992024076795],
  [0.7760,0.020168279398516],
  [0.7770,0.020306468698553],
  [0.7780,0.020407947887368],
  [0.7790,0.020474234348271],
  [0.7800,0.020506862348991],
  [0.7810,0.020507262663130],
  [0.7820,0.020476665266940],
  [0.7830,0.020416038277067],
  [0.7840,0.020326069735603],
  [0.7850,0.020207198085014],
  [0.7860,0.020059665260966],
  [0.7870,0.019883620187085],
  [0.7880,0.019679220367021],
  [0.7890,0.019446759499516],
  [0.7900,0.019186776727223],
  [0.7910,0.018900158039829],
  [0.7920,0.018588211303441],
  [0.7930,0.018252712298803],
  [0.7940,0.017895913182219],
  [0.7950,0.017520516677471],
  [0.7960,0.017129618870830],
  [0.7970,0.016726624724988],
  [0.7980,0.016315144316368],
  [0.7990,0.015898887354617],
  [0.8000,0.015481560662199],
  [0.8010,0.015066796218994],
  [0.8020,0.014658104559696],
  [0.8030,0.014258874027526],
  [0.8040,0.013872412853243],
  [0.8050,0.013502038770328],
  [0.8060,0.013151191050072],
  [0.8070,0.012823563314683],
  [0.8080,0.012523235830852],
  [0.8090,0.012254758791249],
  [0.8100,0.012023176690382],
  [0.8110,0.011833950922869],
  [0.8120,0.011692763199735],
  [0.8130,0.011605195012078],
  [0.8140,0.011576314080458],
  [0.8150,0.011610212186894],
  [0.8160,0.011709591641666],
  [0.8170,0.011875469842602],
  [0.8180,0.012107068085836],
  [0.8190,0.012401913201921],
  [0.8200,0.012756122439953],
  [0.8210,0.013164809335599],
  [0.8220,0.013622538793361],
  [0.8230,0.014123755464147],
  [0.8240,0.014663152106989],
  [0.8250,0.015235924396270],
  [0.8260,0.015837935302090],
  [0.8270,0.016465767791572],
  [0.8280,0.017116697054718],
  [0.8290,0.017788582759337],
  [0.8300,0.018479724157500],
  [0.8310,0.019188683663052],
  [0.8320,0.019914105315566],
  [0.8330,0.020654552426440],
  [0.8340,0.021408379962701],
  [0.8350,0.022173651638120],
  [0.8360,0.022948104534294],
  [0.8370,0.023729164863242],
  [0.8380,0.024514004567009],
  [0.8390,0.025299628202123],
  [0.8400,0.026082980064291],
  [0.8410,0.026861059876956],
  [0.8420,0.027631025004837],
  [0.8430,0.028390286083595],
  [0.8440,0.029136570210742],
  [0.8450,0.029867960908048],
  [0.8460,0.030582895439905],
  [0.8470,0.031280135562720],
  [0.8480,0.031958702997250],
  [0.8490,0.032617794731528],
  [0.8500,0.033256677258866],
  [0.8510,0.033874581433639],
  [0.8520,0.034470604249166],
  [0.8530,0.035043628907434],
  [0.8540,0.035592274341978],
  [0.8550,0.036114872179110],
  [0.8560,0.036609480270941],
  [0.8570,0.037073930967443],
  [0.8580,0.037505902463091],
  [0.8590,0.037903007054198],
  [0.8600,0.038262894146407],
  [0.8610,0.038583351622642],
  [0.8620,0.038862386530305],
  [0.8630,0.039098307589264],
  [0.8640,0.039289757091675],
  [0.8650,0.039435735908900],
  [0.8660,0.039535582185792],
  [0.8670,0.039588925759950],
  [0.8680,0.039595619269727],
  [0.8690,0.039555650508821],
  [0.8700,0.039469048956216],
  [0.8710,0.039335800045015],
  [0.8720,0.039155768350735],
  [0.8730,0.038928651715222],
  [0.8740,0.038653965065702],
  [0.8750,0.038331057288275],
  [0.8760,0.037959167002088],
  [0.8770,0.037537499511801],
  [0.8780,0.037065328318829],
  [0.8790,0.036542102301334],
  [0.8800,0.035967550168374],
  [0.8810,0.035341772880877],
  [0.8820,0.034665302485520],
  [0.8830,0.033939137180158],
  [0.8840,0.033164739326378],
  [0.8850,0.032344001186784],
  [0.8860,0.031479182520678],
  [0.8870,0.030572826170528],
  [0.8880,0.029627666192327],
  [0.8890,0.028646539977416],
  [0.8900,0.027632311218576],
  [0.8910,0.026587823808430],
  [0.8920,0.025515885051106],
  [0.8930,0.024419293455609],
  [0.8940,0.023300913017512],
  [0.8950,0.022163790089786],
  [0.8960,0.021011323706142],
  [0.8970,0.019847473574262],
  [0.8980,0.018677031308249],
  [0.8990,0.017505939939351],
  [0.9000,0.016341701230846],
  [0.9010,0.015193874376756],
  [0.9020,0.014074722177868],
  [0.9030,0.013000019698493],
  [0.9040,0.011990008443441],
  [0.9050,0.011070354707807],
  [0.9060,0.010272681984160],
  [0.9070,0.009633749670090],
  [0.9080,0.009191958588027],
  [0.9090,0.008980356988207],
  [0.9100,0.009017703255351],
  [0.9110,0.009302289055229],
  [0.9120,0.009812854762381],
  [0.9130,0.010515908268305],
  [0.9140,0.011374495426385],
  [0.9150,0.012354336394139],
  [0.9160,0.013426496663279],
  [0.9170,0.014567710854373],
  [0.9180,0.015759618969711],
  [0.9190,0.016987746085819],
  [0.9200,0.018240562820335],
  [0.9210,0.019508754005945],
  [0.9220,0.020784688013909],
  [0.9230,0.022062053975033],
  [0.9240,0.023335616426091],
  [0.9250,0.024601058056653],
  [0.9260,0.025854875273051],
  [0.9270,0.027094301302004],
  [0.9280,0.028317230994080],
  [0.9290,0.029522155715319],
  [0.9300,0.030708080786535],
  [0.9310,0.031874431160418],
  [0.9320,0.033020958788159],
  [0.9330,0.034147634203435],
  [0.9340,0.035254545331314],
  [0.9350,0.036341807974921],
  [0.9360,0.037409481168632],
  [0.9370,0.038457505702026],
  [0.9380,0.039485665375835],
  [0.9390,0.040493565042409],
  [0.9400,0.041480629362075],
  [0.9410,0.042446126286212],
  [0.9420,0.043389197333722],
  [0.9430,0.044308901656430],
  [0.9440,0.045204267433499],
  [0.9450,0.046074339283258],
  [0.9460,0.046918218781088],
  [0.9470,0.047735099469127],
  [0.9480,0.048524286208772],
  [0.9490,0.049285200271118],
  [0.9500,0.050017368411248],
  [0.9510,0.050720401844919],
  [0.9520,0.051393966724043],
  [0.9530,0.052037744621558],
  [0.9540,0.052651399865243],
  [0.9550,0.053234534178137],
  [0.9560,0.053786665386936],
  [0.9570,0.054307200055081],
  [0.9580,0.054795419158341],
  [0.9590,0.055250474347196],
  [0.9600,0.055671398561168],
  [0.9610,0.056057121350682],
  [0.9620,0.056406496981705],
  [0.9630,0.056718331245174],
  [0.9640,0.056991425163216],
  [0.9650,0.057224597129231],
  [0.9660,0.057416723797926],
  [0.9670,0.057566750440102],
  [0.9680,0.057673711543009],
  [0.9690,0.057736727552025],
  [0.9700,0.057754996653642],
  [0.9710,0.057727780867837],
  [0.9720,0.057654382020182],
  [0.9730,0.057534120397822],
  [0.9740,0.057366310578021],
  [0.9750,0.057150248777943],
  [0.9760,0.056885194021467],
  [0.9770,0.056570376130264],
  [0.9780,0.056205005340292],
  [0.9790,0.055788292313809],
  [0.9800,0.055319485301875],
  [0.9810,0.054797910119470],
  [0.9820,0.054223019554008],
  [0.9830,0.053594441379985],
  [0.9840,0.052912022011646],
  [0.9850,0.052175865437798],
  [0.9860,0.051386349831942],
  [0.9870,0.050544143393722],
  [0.9880,0.049650191876631],
  [0.9890,0.048705699544124],
  [0.9900,0.047712097267999],
  [0.9910,0.046671003033281],
  [0.9920,0.045584187421184],
  [0.9930,0.044453545892382],
  [0.9940,0.043281070967325],
  [0.9950,0.042068858091711],
  [0.9960,0.040819113967652],
  [0.9970,0.039534190739722],
  [0.9980,0.038216640353735],
  [0.9990,0.036869280235746],
//  [1.0000,0.035495272757989]
]
